{% liquid
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
  assign header_alignment = section.settings.header_alignment | default: 'start'
  assign first_tab_id = ''
%}

<div class="section-background color-{{ section.settings.section_color_scheme }}"></div>

<section
  class="
    section
    section--{{ section.settings.section_width }}
    color-{{ section.settings.section_color_scheme }}
    tab-collection
    section-resource-list
    spacing-style
    gap-style
  "
  style="
    {% render 'spacing-style', settings: section.settings %}
    {% render 'gap-style', value: section.settings.gap %}
  "
  data-section-id="{{ section.id }}"
>
  <div class="tab-collection__inner tab-collection__inner--align-{{ header_alignment }}">
    {% if heading or subheading %}
      <div class="tab-collection__header">
        {% if heading %}
          <h2 class="tab-collection__heading">{{ heading }}</h2>
        {% endif %}
        {% if subheading %}
          <div class="tab-collection__subheading rte">{{ subheading }}</div>
        {% endif %}
      </div>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <tabs-component class="product-tabs tab-collection__tabs" data-tabs-no-scroll>
        <native-scrollbar class="tabs__head product-tabs__head">
          <ul class="tabs product-tabs-title" role="tablist" data-scrollbar data-scrollbar-slider>
            {% for block in section.blocks %}
              {% liquid
                assign tab_id = 'TabCollection-' | append: section.id | append: '-' | append: block.id
                assign tab_collection = block.settings.collection
                if tab_collection == blank
                  assign tab_collection = block.settings.collection_list | first
                endif
                assign label = block.settings.title

                if label == blank and tab_collection != blank
                  assign label = tab_collection.title
                endif

                if label == blank
                  assign label = 'Collection'
                endif

                if first_tab_id == ''
                  assign first_tab_id = tab_id
                endif
              %}
              <li class="tabs__item" {{ block.shopify_attributes }}>
                <button
                  class="tab-link{% if tab_id == first_tab_id %} current{% endif %}"
                  data-tab="{{ tab_id }}"
                  id="{{ tab_id }}-label"
                  role="tab"
                  aria-selected="{% if tab_id == first_tab_id %}true{% else %}false{% endif %}"
                  aria-controls="{{ tab_id }}-panel"
                  tabindex="{% if tab_id == first_tab_id %}0{% else %}-1{% endif %}"
                  type="button"
                >
                  {{- label -}}
                </button>
              </li>
            {% endfor %}
          </ul>

          <div class="product-tabs__arrows">
            <button
              class="tabs__arrow tabs__arrow--prev"
              type="button"
              aria-label="Previous tab"
              data-tabs-prev
            >
              {{- 'icon-chevron-left.svg' | inline_asset_content -}}
            </button>
            <button
              class="tabs__arrow tabs__arrow--next"
              type="button"
              aria-label="Next tab"
              data-tabs-next
            >
              {{- 'icon-chevron-right.svg' | inline_asset_content -}}
            </button>
          </div>
        </native-scrollbar>

        <div class="tabs__body product-tabs__body tab-collection__panels">
          {% for block in section.blocks %}
            {% liquid
              assign tab_id = 'TabCollection-' | append: section.id | append: '-' | append: block.id
              assign tab_collection = block.settings.collection
              if tab_collection == blank
                assign tab_collection = block.settings.collection_list | first
              endif
              assign max_items = block.settings.max_items | default: 6
              assign show_featured_image = block.settings.show_image
              assign featured_image = block.settings.featured_image
              assign button_label = block.settings.featured_button_text | strip
              assign button_link = block.settings.featured_button_link
              assign button_style = block.settings.featured_button_style | default: 'button'
              assign button_size = block.settings.featured_button_size | default: 'medium'
              assign button_color_scheme = block.settings.featured_button_color_scheme | default: section.settings.section_color_scheme

              if featured_image == blank and tab_collection != blank
                assign featured_image = tab_collection.image
                if featured_image == blank and tab_collection.products_count > 0
                  assign featured_image = tab_collection.products.first.featured_image
                endif
              endif

              if button_link == blank and tab_collection != blank
                assign button_link = tab_collection.url
              endif

              assign product_limit = max_items
              if show_featured_image
                assign product_limit = max_items | minus: 1
                if product_limit < 0
                  assign product_limit = 0
                endif
              endif

              assign product_count = product_limit
              if tab_collection != blank and tab_collection.products_count > 0
                assign product_count = tab_collection.products_count | at_most: product_limit
              endif

              assign slide_count = product_count
              if show_featured_image
                assign slide_count = slide_count | plus: 1
              endif

              assign image_ratio = 'adapt'
              case block.settings.image_ratio
                when 'landscape'
                  assign image_ratio = '16 / 9'
                when 'portrait'
                  assign image_ratio = '4 / 5'
                when 'square'
                  assign image_ratio = '1 / 1'
                when 'circle'
                  assign image_ratio = '1 / 1'
                when 'adapt'
                  assign image_ratio = 'adapt'
              endcase

              assign featured_ratio = image_ratio
              if featured_ratio == 'adapt'
                if featured_image != blank and featured_image.aspect_ratio != blank
                  assign featured_ratio = featured_image.aspect_ratio
                else
                  assign featured_ratio = 1
                endif
              endif
            %}

            {% capture featured_item %}
              {% if show_featured_image %}
                <div
                  class="
                    resource-list__item
                    tab-collection__item
                    tab-collection__item--featured
                    border-style
                    {% if block.settings.inherit_color_scheme == false %} color-{{ block.settings.color_scheme }}{% endif %}
                  "
                  style="
                    {% render 'border-override', settings: block.settings %}
                    --resource-card-corner-radius: {{ block.settings.border_radius }}px;
                    --tab-collection-featured-ratio: {{ featured_ratio }};
                  "
                  {% if tab_collection != blank %}
                    data-origin-collection-handle="{{ tab_collection.handle }}"
                    data-origin-collection-title="{{ tab_collection.title | escape }}"
                    data-origin-collection-url="{{ tab_collection.url | escape }}"
                  {% endif %}
                >
                  {% capture featured_media %}
                    <div class="tab-collection__featured-media{% if block.settings.align_with_product_images %} tab-collection__featured-media--aligned{% endif %}">
                      {% if featured_image != blank %}
                        {{
                          featured_image
                          | image_url: width: 2000
                          | image_tag:
                            loading: 'lazy',
                            class: 'tab-collection__featured-image',
                            widths: '320, 480, 640, 840, 1080, 1280, 1600, 2000',
                            sizes: '(min-width: 750px) 30vw, 80vw'
                        }}
                      {% else %}
                        {{ 'collection-apparel-1' | placeholder_svg_tag: 'tab-collection__featured-placeholder' }}
                      {% endif %}

                      {% if tab_collection != blank %}
                        <a
                          class="tab-collection__featured-link"
                          href="{{ tab_collection.url }}"
                          aria-label="{{ tab_collection.title | escape }}"
                        ></a>
                      {% endif %}

                      {% if button_label != blank and button_link != blank %}
                        <div class="tab-collection__featured-button-wrap color-{{ button_color_scheme }}">
                          <a
                            class="tab-collection__featured-button {{ button_style }} tab-collection__featured-button--{{ button_size }}"
                            href="{{ button_link }}"
                          >
                            {{- button_label -}}
                          </a>
                        </div>
                      {% endif %}
                    </div>
                  {% endcapture %}

                  {{ featured_media }}
                </div>
              {% endif %}
            {% endcapture %}

            {% capture product_items %}
              {% if product_limit > 0 and tab_collection != blank and tab_collection.products_count > 0 %}
                {% for tab_product in tab_collection.products limit: product_limit %}
                  {% capture tab_product_content %}
                    {% render 'tab-collection-product-content', product: tab_product, block_settings: block.settings %}
                  {% endcapture %}
                  <div
                    class="
                      resource-list__item
                      tab-collection__item
                      border-style
                      {% if block.settings.inherit_color_scheme == false %} color-{{ block.settings.color_scheme }}{% endif %}
                    "
                    style="
                      {% render 'border-override', settings: block.settings %}
                      --resource-card-corner-radius: {{ block.settings.border_radius }}px;
                    "
                    data-origin-collection-handle="{{ tab_collection.handle }}"
                    data-origin-collection-title="{{ tab_collection.title | escape }}"
                    data-origin-collection-url="{{ tab_collection.url | escape }}"
                  >
                    {% render 'resource-card',
                      resource: tab_product,
                      resource_type: 'product',
                      image_aspect_ratio: image_ratio,
                      image_hover: settings.show_second_image_on_hover,
                      show_wishlist_button: true,
                      show_badges: true,
                      content_markup: tab_product_content,
                      collection: tab_collection,
                      show_quick_add: true,
                      quick_add_section_id: section.id,
                      quick_add_block: block
                    %}
                  </div>
                  {% unless forloop.last %}
                    <!--@list/split-->
                  {% endunless %}
                {% endfor %}
              {% elsif product_limit > 0 %}
                {% for i in (1..product_limit) %}
                  {% capture tab_product_content %}
                    {% render 'tab-collection-product-content', product: blank, block_settings: block.settings %}
                  {% endcapture %}
                  <div
                    class="
                      resource-list__item
                      tab-collection__item
                      border-style
                      {% if block.settings.inherit_color_scheme == false %} color-{{ block.settings.color_scheme }}{% endif %}
                    "
                    style="
                      {% render 'border-override', settings: block.settings %}
                      --resource-card-corner-radius: {{ block.settings.border_radius }}px;
                    "
                  >
                    {% render 'resource-card',
                      resource: blank,
                      resource_type: 'product',
                      image_aspect_ratio: image_ratio,
                      show_wishlist_button: false,
                      content_markup: tab_product_content
                    %}
                  </div>
                  {% unless forloop.last %}
                    <!--@list/split-->
                  {% endunless %}
                {% endfor %}
              {% endif %}
            {% endcapture %}

            {% capture list_items %}
              {% if show_featured_image %}
                {{ featured_item }}
                {% if product_items != blank %}
                  <!--@list/split-->
                {% endif %}
              {% endif %}
              {{ product_items }}
            {% endcapture %}

            {% assign list_items_array = list_items | strip | split: '<!--@list/split-->' %}

            <div
              class="tab-content{% if tab_id == first_tab_id %} current{% endif %}"
              id="{{ tab_id }}-panel"
              role="tabpanel"
              aria-labelledby="{{ tab_id }}-label"
              data-tab-content="{{ tab_id }}"
              {% unless tab_id == first_tab_id %}hidden{% endunless %}
            >
              {% render 'resource-list',
                list_items: list_items,
                list_items_array: list_items_array,
                settings: section.settings,
                carousel_ref: 'TabCollectionCarousel-' | append: section.id | append: '-' | append: block.id,
                slide_count: slide_count,
                content_type: 'products',
                test_id: 'tab-collection-carousel'
              %}
            </div>
          {% endfor %}
        </div>
      </tabs-component>
    {% else %}
      <div class="tab-collection__empty">
        {{ 'sections.onboarding.no_content' | t | default: 'Add tabs to show collections.' }}
      </div>
    {% endif %}
  </div>
</section>

<script>
  (() => {
    const section = document.querySelector('.tab-collection[data-section-id="{{ section.id }}"]');
    if (!section) return;

    section.addEventListener('variant:update', (event) => {
      if (!(event.target instanceof HTMLElement)) return;
      const swatchComponent = event.target.closest('swatches-variant-picker-component');
      if (!swatchComponent) return;
      const card = swatchComponent.closest('.tab-collection__item');
      if (!card) return;
      const link = card.querySelector('.resource-card__link');
      if (!(link instanceof HTMLAnchorElement)) return;

      const newProductUrl = event.detail?.data?.newProduct?.url || swatchComponent.dataset.productUrl;
      if (!newProductUrl) return;

      const url = new URL(newProductUrl, window.location.origin);
      const variantId = event.detail?.resource?.id;
      if (variantId) {
        url.searchParams.set('variant', variantId);
      } else {
        url.searchParams.delete('variant');
      }

      link.href = url.toString();
    });
  })();
</script>

{% schema %}
{
  "name": "t:sections.tab_collection.name",
  "tag": "section",
  "class": "tab-collection-section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.tab_collection.settings.heading.label",
      "default": "Shop collections"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "t:sections.tab_collection.settings.subheading.label"
    },
    {
      "type": "select",
      "id": "header_alignment",
      "label": "t:sections.tab_collection.settings.header_alignment.label",
      "options": [
        { "value": "start", "label": "t:sections.tab_collection.settings.header_alignment.options.start" },
        { "value": "center", "label": "t:sections.tab_collection.settings.header_alignment.options.center" }
      ],
      "default": "start"
    },
    {
      "type": "select",
      "id": "layout_type",
      "label": "t:sections.tab_collection.settings.layout_type.label",
      "options": [
        { "value": "grid", "label": "t:sections.tab_collection.settings.layout_type.options.grid" },
        { "value": "carousel", "label": "t:sections.tab_collection.settings.layout_type.options.carousel" }
      ],
      "default": "carousel"
    },
    {
      "type": "range",
      "id": "columns",
      "label": "t:sections.tab_collection.settings.columns.label",
      "min": 1,
      "max": 8,
      "step": 1,
      "default": 4
    },
    {
      "type": "range",
      "id": "columns_gap",
      "label": "t:sections.tab_collection.settings.columns_gap.label",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "t:sections.tab_collection.settings.carousel_navigation"
    },
    {
      "type": "select",
      "id": "icons_style",
      "label": "t:sections.tab_collection.settings.icons_style.label",
      "options": [
        { "value": "arrow", "label": "t:sections.tab_collection.settings.icons_style.options.arrow" },
        { "value": "chevron", "label": "t:sections.tab_collection.settings.icons_style.options.chevron" },
        { "value": "arrows_large", "label": "t:sections.tab_collection.settings.icons_style.options.arrows_large" },
        { "value": "chevron_large", "label": "t:sections.tab_collection.settings.icons_style.options.chevron_large" },
        { "value": "none", "label": "t:sections.tab_collection.settings.icons_style.options.none" }
      ],
      "default": "arrow"
    },
    {
      "type": "select",
      "id": "icons_shape",
      "label": "t:sections.tab_collection.settings.icons_shape.label",
      "options": [
        { "value": "none", "label": "t:sections.tab_collection.settings.icons_shape.options.none" },
        { "value": "circle", "label": "t:sections.tab_collection.settings.icons_shape.options.circle" },
        { "value": "square", "label": "t:sections.tab_collection.settings.icons_shape.options.square" }
      ],
      "default": "none",
      "visible_if": "{{ section.settings.icons_style != 'none' }}"
    },
    {
      "type": "header",
      "content": "t:sections.tab_collection.settings.section_layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:sections.tab_collection.settings.section_width.label",
      "options": [
        { "value": "page-width", "label": "t:sections.tab_collection.settings.section_width.options.page" },
        { "value": "full-width", "label": "t:sections.tab_collection.settings.section_width.options.full" }
      ],
      "default": "page-width"
    },
    {
      "type": "color_scheme",
      "id": "section_color_scheme",
      "label": "t:sections.tab_collection.settings.section_color_scheme.label",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:sections.tab_collection.settings.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:sections.tab_collection.settings.padding_block_start.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:sections.tab_collection.settings.padding_block_end.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "padding-inline-start",
      "label": "t:sections.tab_collection.settings.padding_inline_start.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-end",
      "label": "t:sections.tab_collection.settings.padding_inline_end.label",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "tab",
      "name": "t:sections.tab_collection.blocks.tab.name",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "t:sections.tab_collection.blocks.tab.settings.title.label",
          "default": "Collection"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "t:sections.tab_collection.blocks.tab.settings.collection.label"
        },
        {
          "type": "range",
          "id": "max_items",
          "label": "t:sections.tab_collection.blocks.tab.settings.max_items.label",
          "min": 1,
          "max": 16,
          "step": 1,
          "default": 6
        },
        {
          "type": "header",
          "content": "t:sections.tab_collection.blocks.tab.settings.appearance"
        },
        {
          "type": "checkbox",
          "id": "inherit_color_scheme",
          "label": "t:sections.tab_collection.blocks.tab.settings.inherit_color_scheme.label",
          "default": true
        },
        {
          "type": "color_scheme",
          "id": "color_scheme",
          "label": "t:sections.tab_collection.blocks.tab.settings.color_scheme.label",
          "default": "scheme-1",
          "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
        },
        {
          "type": "select",
          "id": "border",
          "label": "t:sections.tab_collection.blocks.tab.settings.border.label",
          "options": [
            { "value": "none", "label": "t:sections.tab_collection.blocks.tab.settings.border.options.none" },
            { "value": "solid", "label": "t:sections.tab_collection.blocks.tab.settings.border.options.solid" }
          ],
          "default": "none"
        },
        {
          "type": "range",
          "id": "border_width",
          "min": 0,
          "max": 10,
          "step": 0.5,
          "unit": "px",
          "label": "t:sections.tab_collection.blocks.tab.settings.border_width.label",
          "default": 1,
          "visible_if": "{{ block.settings.border != 'none' }}"
        },
        {
          "type": "range",
          "id": "border_opacity",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "t:sections.tab_collection.blocks.tab.settings.border_opacity.label",
          "default": 100,
          "visible_if": "{{ block.settings.border != 'none' }}"
        },
        {
          "type": "range",
          "id": "border_radius",
          "label": "t:sections.tab_collection.blocks.tab.settings.border_radius.label",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "header",
          "content": "t:sections.tab_collection.blocks.tab.settings.image"
        },
        {
          "type": "checkbox",
          "id": "show_image",
          "label": "t:sections.tab_collection.blocks.tab.settings.show_image.label",
          "default": false
        },
        {
          "type": "image_picker",
          "id": "featured_image",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_image.label",
          "info": "t:sections.tab_collection.blocks.tab.settings.featured_image.info",
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "checkbox",
          "id": "align_with_product_images",
          "label": "t:sections.tab_collection.blocks.tab.settings.align_with_product_images.label",
          "default": false,
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "select",
          "id": "image_ratio",
          "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.label",
          "info": "t:sections.tab_collection.blocks.tab.settings.image_ratio.info",
          "options": [
            { "value": "adapt", "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.options.adapt" },
            { "value": "portrait", "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.options.portrait" },
            { "value": "square", "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.options.square" },
            { "value": "circle", "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.options.circle" },
            { "value": "landscape", "label": "t:sections.tab_collection.blocks.tab.settings.image_ratio.options.landscape" }
          ],
          "default": "portrait"
        },
        {
          "type": "checkbox",
          "id": "toggle_overlay",
          "label": "t:sections.tab_collection.blocks.tab.settings.toggle_overlay.label",
          "default": false
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "t:sections.tab_collection.blocks.tab.settings.overlay_color.label",
          "alpha": true,
          "default": "#00000026",
          "visible_if": "{{ block.settings.toggle_overlay }}"
        },
        {
          "type": "select",
          "id": "overlay_style",
          "label": "t:sections.tab_collection.blocks.tab.settings.overlay_style.label",
          "options": [
            { "value": "solid", "label": "t:sections.tab_collection.blocks.tab.settings.overlay_style.options.solid" },
            { "value": "gradient", "label": "t:sections.tab_collection.blocks.tab.settings.overlay_style.options.gradient" }
          ],
          "default": "solid",
          "visible_if": "{{ block.settings.toggle_overlay }}"
        },
        {
          "type": "select",
          "id": "gradient_direction",
          "label": "t:sections.tab_collection.blocks.tab.settings.gradient_direction.label",
          "options": [
            { "value": "to top", "label": "t:sections.tab_collection.blocks.tab.settings.gradient_direction.options.to_top" },
            { "value": "to bottom", "label": "t:sections.tab_collection.blocks.tab.settings.gradient_direction.options.to_bottom" }
          ],
          "default": "to top",
          "visible_if": "{{ block.settings.toggle_overlay and block.settings.overlay_style == 'gradient' }}"
        },
        {
          "type": "header",
          "content": "t:sections.tab_collection.blocks.tab.settings.button",
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "text",
          "id": "featured_button_text",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_text.label",
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "url",
          "id": "featured_button_link",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_link.label",
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "select",
          "id": "featured_button_style",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_style.label",
          "default": "button",
          "options": [
            { "value": "button", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_style.options.primary" },
            { "value": "button-secondary", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_style.options.secondary" },
            { "value": "link", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_style.options.link" }
          ],
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "select",
          "id": "featured_button_size",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_size.label",
          "default": "medium",
          "options": [
            { "value": "small", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_size.options.small" },
            { "value": "medium", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_size.options.medium" },
            { "value": "large", "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_size.options.large" }
          ],
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "color_scheme",
          "id": "featured_button_color_scheme",
          "label": "t:sections.tab_collection.blocks.tab.settings.featured_button_color_scheme.label",
          "default": "scheme-1",
          "visible_if": "{{ block.settings.show_image }}"
        },
        {
          "type": "header",
          "content": "t:sections.tab_collection.blocks.tab.settings.product_title"
        },
        {
          "type": "select",
          "id": "product_title_type_preset",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.label",
          "options": [
            { "value": "rte", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.default" },
            { "value": "paragraph", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.paragraph" },
            { "value": "h1", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h1" },
            { "value": "h2", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h2" },
            { "value": "h3", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h3" },
            { "value": "h4", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h4" },
            { "value": "h5", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h5" },
            { "value": "h6", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_type_preset.options.h6" }
          ],
          "default": "paragraph"
        },
        {
          "type": "select",
          "id": "product_title_heading_size",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.label",
          "options": [
            { "value": "", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.default" },
            { "value": "0.75rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.size_12" },
            { "value": "0.875rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.size_14" },
            { "value": "1rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.size_16" },
            { "value": "1.125rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.size_18" },
            { "value": "1.25rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_heading_size.options.size_20" }
          ],
          "visible_if": "{{ block.settings.product_title_type_preset != 'rte' }}"
        },
        {
          "type": "select",
          "id": "product_title_font",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_font.label",
          "options": [
            { "value": "var(--font-body--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_font.options.body" },
            { "value": "var(--font-subheading--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_font.options.subheading" },
            { "value": "var(--font-heading--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_font.options.heading" },
            { "value": "var(--font-accent--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_font.options.accent" }
          ],
          "default": "var(--font-body--family)"
        },
        {
          "type": "select",
          "id": "product_title_color",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_color.label",
          "options": [
            { "value": "var(--color-foreground)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_color.options.text" },
            { "value": "var(--color-foreground-heading)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_color.options.heading" },
            { "value": "var(--color-primary)", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_color.options.link" }
          ],
          "default": "var(--color-foreground)",
          "visible_if": "{{ block.settings.product_title_type_preset != 'rte' }}"
        },
        {
          "type": "select",
          "id": "product_title_width",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_width.label",
          "options": [
            { "value": "fit-content", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_width.options.fit_content" },
            { "value": "100%", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_width.options.full_width" }
          ],
          "default": "fit-content"
        },
        {
          "type": "select",
          "id": "product_title_max_width",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_max_width.label",
          "options": [
            { "value": "narrow", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_max_width.options.narrow" },
            { "value": "normal", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_max_width.options.normal" },
            { "value": "none", "label": "t:sections.tab_collection.blocks.tab.settings.product_title_max_width.options.none" }
          ],
          "default": "normal"
        },
        {
          "type": "text_alignment",
          "id": "product_title_alignment",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_alignment.label",
          "default": "left",
          "visible_if": "{{ block.settings.product_title_width == '100%' }}"
        },
        {
          "type": "checkbox",
          "id": "product_title_background",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_background.label",
          "default": false
        },
        {
          "type": "color",
          "id": "product_title_background_color",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_background_color.label",
          "alpha": true,
          "default": "#00000026",
          "visible_if": "{{ block.settings.product_title_background }}"
        },
        {
          "type": "range",
          "id": "product_title_corner_radius",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_title_corner_radius.label",
          "default": 0,
          "min": 0,
          "max": 50,
          "step": 1,
          "visible_if": "{{ block.settings.product_title_background }}"
        },
        {
          "type": "header",
          "content": "t:sections.tab_collection.blocks.tab.settings.product_price"
        },
        {
          "type": "checkbox",
          "id": "product_price_show_sale_first",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_show_sale_first.label",
          "default": true
        },
        {
          "type": "select",
          "id": "product_price_type_preset",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.label",
          "options": [
            { "value": "", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.default" },
            { "value": "paragraph", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.paragraph" },
            { "value": "h1", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h1" },
            { "value": "h2", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h2" },
            { "value": "h3", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h3" },
            { "value": "h4", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h4" },
            { "value": "h5", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h5" },
            { "value": "h6", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.h6" },
            { "value": "custom", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_type_preset.options.custom" }
          ],
          "default": ""
        },
        {
          "type": "select",
          "id": "product_price_width",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_width.label",
          "options": [
            { "value": "fit-content", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_width.options.fit_content" },
            { "value": "100%", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_width.options.full_width" }
          ],
          "default": "100%"
        },
        {
          "type": "text_alignment",
          "id": "product_price_alignment",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_alignment.label",
          "default": "left",
          "visible_if": "{{ block.settings.product_price_width != 'fit-content' }}"
        },
        {
          "type": "select",
          "id": "product_price_font",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font.label",
          "options": [
            { "value": "var(--font-body--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font.options.body" },
            { "value": "var(--font-subheading--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font.options.subheading" },
            { "value": "var(--font-heading--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font.options.heading" },
            { "value": "var(--font-accent--family)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font.options.accent" }
          ],
          "default": "var(--font-body--family)",
          "visible_if": "{{ block.settings.product_price_type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "product_price_font_size",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.label",
          "options": [
            { "value": "0.625rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_10" },
            { "value": "0.75rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_12" },
            { "value": "0.875rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_14" },
            { "value": "1rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_16" },
            { "value": "1.125rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_18" },
            { "value": "1.25rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_20" },
            { "value": "1.5rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_24" },
            { "value": "2rem", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_font_size.options.size_32" }
          ],
          "default": "1rem",
          "visible_if": "{{ block.settings.product_price_type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "product_price_line_height",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_line_height.label",
          "options": [
            { "value": "tight", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_line_height.options.tight" },
            { "value": "normal", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_line_height.options.normal" },
            { "value": "loose", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_line_height.options.loose" }
          ],
          "default": "normal",
          "visible_if": "{{ block.settings.product_price_type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "product_price_letter_spacing",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_letter_spacing.label",
          "options": [
            { "value": "tight", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_letter_spacing.options.tight" },
            { "value": "normal", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_letter_spacing.options.normal" },
            { "value": "loose", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_letter_spacing.options.loose" }
          ],
          "default": "normal",
          "visible_if": "{{ block.settings.product_price_type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "product_price_case",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_case.label",
          "options": [
            { "value": "none", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_case.options.default" },
            { "value": "uppercase", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_case.options.uppercase" }
          ],
          "default": "none",
          "visible_if": "{{ block.settings.product_price_type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "product_price_color",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_color.label",
          "options": [
            { "value": "var(--color-foreground)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_color.options.text" },
            { "value": "var(--color-foreground-heading)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_color.options.heading" },
            { "value": "var(--color-primary)", "label": "t:sections.tab_collection.blocks.tab.settings.product_price_color.options.link" }
          ],
          "default": "var(--color-foreground)"
        },
        {
          "type": "checkbox",
          "id": "product_price_background",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_background.label",
          "default": false
        },
        {
          "type": "color",
          "id": "product_price_background_color",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_background_color.label",
          "alpha": true,
          "default": "#00000026",
          "visible_if": "{{ block.settings.product_price_background }}"
        },
        {
          "type": "range",
          "id": "product_price_corner_radius",
          "label": "t:sections.tab_collection.blocks.tab.settings.product_price_corner_radius.label",
          "default": 0,
          "min": 0,
          "max": 50,
          "step": 1,
          "visible_if": "{{ block.settings.product_price_background }}"
        },
        {
          "type": "header",
          "content": "t:names.swatches"
        },
        {
          "type": "select",
          "id": "product_swatches_alignment",
          "label": "t:settings.alignment",
          "options": [
            { "value": "flex-start", "label": "t:options.left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "flex-end", "label": "t:options.right" }
          ],
          "default": "flex-start"
        },
        {
          "type": "select",
          "id": "product_swatches_alignment_mobile",
          "label": "t:settings.alignment_mobile",
          "options": [
            { "value": "flex-start", "label": "t:options.left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "flex-end", "label": "t:options.right" }
          ],
          "default": "flex-start"
        },
        {
          "type": "header",
          "content": "t:content.padding"
        },
        {
          "type": "range",
          "id": "product_swatches_padding_top",
          "label": "t:settings.top",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 4
        },
        {
          "type": "range",
          "id": "product_swatches_padding_bottom",
          "label": "t:settings.bottom",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "product_swatches_padding_left",
          "label": "t:settings.left",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "product_swatches_padding_right",
          "label": "t:settings.right",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.tab_collection.presets.default.name",
      "category": "t:categories.collections",
      "blocks": [
        { "type": "tab" },
        { "type": "tab" }
      ]
    }
  ]
}
{% endschema %}

{% stylesheet %}
  .tab-collection__inner {
    width: 100%;
  }

  .tab-collection__header {
    display: grid;
    gap: 8px;
  }

  .tab-collection__tabs {
    overflow-anchor: none;
  }

  .tab-collection__heading {
    margin: 0;
  }

  .tab-collection__panels {
    margin-top: 12px;
    overflow-anchor: none;
  }

  .tab-collection__panels .tab-content {
    overflow-anchor: none;
  }

  .tab-collection__item .resource-card__media {
    --padding-block-start: 0px;
    --padding-inline-start: 0px;
  }

  .tab-collection__inner--align-center .tab-collection__header,
  .tab-collection__inner--align-center .product-tabs__head {
    justify-content: center;
  }

  .tab-collection__inner--align-center .tab-collection__header {
    text-align: center;
  }

  .tab-collection__inner--align-center .product-tabs__head .tabs {
    justify-content: center;
  }

  .tab-collection__featured-link {
    display: block;
    width: 100%;
    height: 100%;
    color: inherit;
    text-decoration: none;
    position: absolute;
    inset: 0;
    z-index: 1;
  }

  .tab-collection__featured-media {
    width: 100%;
    position: relative;
  }

  .tab-collection__featured-media:not(.tab-collection__featured-media--aligned) {
    height: 100%;
  }

  .tab-collection__featured-media--aligned {
    aspect-ratio: var(--tab-collection-featured-ratio, auto);
  }

  .tab-collection__featured-image {
    display: block;
    width: 100%;
    height: auto;
  }

  .tab-collection__featured-media:not(.tab-collection__featured-media--aligned) .tab-collection__featured-image {
    height: 100%;
    object-fit: cover;
  }

  .tab-collection__featured-media--aligned .tab-collection__featured-image {
    height: 100%;
    object-fit: cover;
  }

  .tab-collection__featured-placeholder {
    display: block;
    width: 100%;
    height: auto;
    background: rgb(var(--color-foreground-rgb) / var(--opacity-5));
  }

  .tab-collection__featured-media:not(.tab-collection__featured-media--aligned) .tab-collection__featured-placeholder {
    height: 100%;
  }

  .tab-collection__featured-media--aligned .tab-collection__featured-placeholder {
    height: 100%;
  }

  .tab-collection__featured-button-wrap {
    position: absolute;
    left: var(--padding-sm);
    bottom: var(--padding-sm);
    right: auto;
    z-index: 2;
    display: flex;
    align-items: center;
    max-width: calc(100% - (var(--padding-sm) * 2));
    background-color: transparent;
  }

  .tab-collection__featured-button {
    pointer-events: auto;
  }

  .tab-collection__featured-button--small {
    --button-padding-block: var(--padding-xs);
    --button-padding-inline: var(--padding-md);
    font-size: var(--font-size--sm);
  }

  .tab-collection__featured-button--medium {
    --button-padding-block: var(--padding-lg);
    --button-padding-inline: var(--padding-2xl);
    font-size: var(--font-paragraph--size);
  }

  .tab-collection__featured-button--large {
    --button-padding-block: var(--padding-xl);
    --button-padding-inline: var(--padding-3xl);
    font-size: var(--font-size--lg);
  }

  .tab-collection__swatches {
    position: relative;
    z-index: 2;
    width: 100%;
    display: flex;
    overflow: hidden;
    gap: 0;
    flex-shrink: 0;
  }

  .tab-collection__swatches swatches-variant-picker-component {
    display: flex;
    width: 100%;
    flex-direction: row;
    justify-content: var(--product-swatches-alignment-mobile);

    @media (min-width: 750px) {
      justify-content: var(--product-swatches-alignment);
    }
  }

  .tab-collection__swatches swatches-variant-picker-component .variant-option--swatches {
    padding-block: calc(
        var(--product-swatches-padding-block-start) + var(--focus-outline-offset) + var(--focus-outline-width)
      )
      calc(var(--product-swatches-padding-block-end) + var(--focus-outline-offset) + var(--focus-outline-width));
    padding-inline: calc(
        var(--product-swatches-padding-inline-start) + var(--focus-outline-offset) + (1.5 * var(--focus-outline-width))
      )
      calc(var(--product-swatches-padding-inline-end) + var(--focus-outline-offset) + var(--focus-outline-width));
  }

  .tab-collection .variant-option--swatches {
    overflow-list::part(list) {
      gap: var(--gap-sm);
    }

    overflow-list[defer]::part(list) {
      flex-wrap: nowrap;
    }
  }

  .tab-collection .hidden-swatches__count {
    display: flex;
    align-self: center;
    align-items: center;
    justify-content: center;
    color: rgb(var(--color-foreground-rgb) / var(--opacity-40-60));
    background-color: transparent;
    padding: 0;
    border: 0;
    border-radius: 0;

    &::before {
      /* This doesn't work in Safari without the counter-reset. https://stackoverflow.com/a/40179718 */
      counter-reset: overflow-count var(--overflow-count);
      content: '+' counter(overflow-count);
      line-height: 1;
      cursor: pointer;
    }
  }

  .tab-collection .hidden-swatches__count:hover {
    color: var(--color-foreground-rgb);
  }

  .tab-collection__empty {
    text-align: center;
    padding: var(--gap-xl);
    border: 1px dashed rgb(var(--color-border-rgb, 0 0 0) / 0.35);
    border-radius: var(--style-border-radius-cards, 12px);
  }
{% endstylesheet %}
